[user]
name = "Omar Kohl"

[ui]
editor = "vim"
default-command = "log"

[templates]
draft_commit_description = '''
concat(
  description,
  surround(
    "\nJJ: This commit contains the following changes:\n", "",
    indent("JJ:     ", diff.stat(72)),
  ),
  "\nJJ: ignore-rest\n",
  diff.git(),
)
'''

[template-aliases]
# Display author timestamp instead of committer timestamp
'commit_timestamp(commit)' = 'commit.author().timestamp()'

[revsets]
log = "present(@) | ancestors(immutable_heads().., 7) | present(trunk())"

[git]
private-commits = "description(glob:'private:*')"

[aliases]
# advance 'main'
adm = ["bookmark", "set", "main", "-r", "main+"]
add-parent = ["util", "exec", "--", "bash", "-c", """
set -euo pipefail
if [ "${1:-}" = "-h" ] || [ "${1:-}" = "--help" ]; then
  echo "Usage: jj add-parent <revision> <parent>"
  echo ""
  echo "Add a new parent to a revision while keeping existing parents."
  echo ""
  echo "Arguments:"
  echo "  <revision>  The revision to modify"
  echo "  <parent>    The parent revision to add"
  exit 0
fi
jj rebase -s ${1} -d ${1}- -d ${2}
jj simplify-parents -r ${1}
""", ""]
rm-parent = ["util", "exec", "--", "bash", "-c", """
set -euo pipefail
if [ "${1:-}" = "-h" ] || [ "${1:-}" = "--help" ]; then
  echo "Usage: jj rm-parent <revision> <parent>"
  echo ""
  echo "Remove a parent of a revision while keeping other parents."
  echo ""
  echo "Arguments:"
  echo "  <revision>  The revision to modify"
  echo "  <parent>    The parent revision to remove"
  exit 0
fi
jj rebase -s ${1} -d "${1}- ~ ${2}"
jj simplify-parents -r ${1}
""", ""]
